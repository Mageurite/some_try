# Avatar 视频打不开 - 故障排查指南

## ✅ 当前服务状态（已确认）
- Avatar服务: ✅ 运行中 (PID: 946848)
- 端口8615: ✅ 正在监听
- webrtcapi.html: ✅ 文件存在且可访问

## 🔍 请告诉我具体情况

### 1. 你是在哪里打开的？
- [ ] 服务器本机的浏览器
- [ ] 其他电脑的浏览器（远程访问）

### 2. 你使用的是哪个地址？
- [ ] http://localhost:8615/webrtcapi.html
- [ ] http://127.0.0.1:8615/webrtcapi.html
- [ ] http://172.18.0.2:8615/webrtcapi.html
- [ ] http://其他IP:8615/webrtcapi.html

### 3. 浏览器显示什么错误？
- [ ] 无法访问此网站 / 连接被拒绝
- [ ] 页面可以打开，但是没有视频
- [ ] 页面空白
- [ ] 其他错误: ______________

## 📋 解决方案（按优先级）

### 方案1: 确认你在服务器本机
如果你在服务器本机（Docker容器内或宿主机上），使用：
```
http://localhost:8615/webrtcapi.html
```

### 方案2: 如果从远程访问
你需要：
1. 先找到宿主机的IP地址（不能用172.18.0.2）
2. 确保Docker端口已映射
3. 确保防火墙允许8615端口

检查Docker端口映射：
```bash
# 在宿主机上运行（不是容器内）
docker ps | grep lip-sync
```

### 方案3: 使用端口转发（如果是SSH连接）
如果你通过SSH连接到服务器，可以使用端口转发：
```bash
# 在你的本地电脑上运行
ssh -L 8615:localhost:8615 用户名@服务器IP

# 然后在本地浏览器访问
http://localhost:8615/webrtcapi.html
```

### 方案4: 尝试其他页面
试试这些页面：
```
http://localhost:8615/dashboard.html
http://localhost:8615/webrtcchat.html
http://localhost:8615/webrtc.html
```

## 🧪 快速测试命令

在服务器终端运行这些命令来诊断：

```bash
# 测试1: 检查页面是否可以下载
curl http://localhost:8615/webrtcapi.html -o /tmp/test.html && echo "✅ 页面可以访问"

# 测试2: 检查端口是否开放
nc -zv localhost 8615 && echo "✅ 端口开放"

# 测试3: 查看防火墙状态
sudo ufw status 2>/dev/null || sudo iptables -L -n | grep 8615

# 测试4: 查看最新日志
tail -50 /workspace/murphy/capstone-project-25t3-9900-virtual-tutor-phase-2/lip-sync/livetalking.log
```

## 🌐 浏览器要求

确保你的浏览器：
- ✅ 支持WebRTC（Chrome、Firefox、Edge、Safari）
- ✅ 允许访问摄像头/麦克风权限
- ✅ 没有禁用JavaScript
- ✅ 不是IE浏览器

## 🆘 仍然无法访问？

请提供以下信息：
1. 你的访问方式（本机/远程）
2. 使用的完整URL地址
3. 浏览器控制台的错误信息（按F12查看）
4. 运行上面"快速测试命令"的结果

## 📞 常见问题

### Q: 页面打开了但没有视频
**A:** 点击页面上的 "Start" 按钮来建立WebRTC连接

### Q: 显示"连接失败"
**A:** 检查：
1. Avatar服务是否在运行
2. 网络连接是否正常
3. 浏览器是否允许WebRTC

### Q: 视频卡顿或黑屏
**A:** 
1. 刷新页面重新连接
2. 检查服务器CPU/内存使用情况
3. 确认avatar图片已加载完成

### Q: 403 Forbidden
**A:** 不要访问根路径 http://localhost:8615/，要加上具体的页面路径






